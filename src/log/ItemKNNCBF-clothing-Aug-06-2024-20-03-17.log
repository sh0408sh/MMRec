Tue 06 Aug 2024 20:03:17 INFO ██Server: 	sanghui001
Tue 06 Aug 2024 20:03:17 INFO ██Dir: 	/home/sh0408sh/workspace/MMRec/src

Tue 06 Aug 2024 20:03:17 INFO 
gpu_id=0
use_gpu=True
seed=[999]
data_path=../data/
inter_splitting_label=x_label
filter_out_cod_start_users=True
is_multimodal_model=True
checkpoint_dir=saved
save_recommended_topk=True
recommend_topk=recommend_topk/
embedding_size=64
weight_decay=0.0
req_training=False
epochs=1
stopping_step=20
train_batch_size=2048
learner=adam
learning_rate=0.001
learning_rate_scheduler=[1.0, 50]
eval_step=1
training_neg_sample_num=1
use_neg_sampling=True
use_full_sampling=False
NEG_PREFIX=neg__
USER_ID_FIELD=userID
ITEM_ID_FIELD=itemID
TIME_FIELD=timestamp
field_separator=	
metrics=['Recall', 'NDCG', 'Precision', 'MAP']
topk=[5, 10, 20, 50]
valid_metric=Recall@20
eval_batch_size=4096
use_raw_features=False
max_txt_len=32
max_img_size=256
vocab_size=30522
type_vocab_size=2
hidden_size=4
pad_token_id=0
max_position_embeddings=512
layer_norm_eps=1e-12
hidden_dropout_prob=0.1
end2end=False
hyper_parameters=['seed', 'shrink', 'knn_k']
inter_file_name=clothing.inter
vision_feature_file=image_feat.npy
text_feature_file=text_feat.npy
user_graph_dict_file=user_graph_dict.npy
knn_k=[10]
shrink=[10]
model=ItemKNNCBF
dataset=clothing
valid_metric_bigger=True
device=cuda


Tue 06 Aug 2024 20:03:17 INFO clothing
The number of users: 39387
Average actions of users: 7.075354812501587
The number of items: 23033
Average actions of items: 12.099031823904832
The number of inters: 278677
The sparsity of the dataset: 99.969281661909%
Tue 06 Aug 2024 20:03:17 INFO 
====Training====
clothing
The number of users: 39387
Average actions of users: 5.010231802371341
The number of items: 23020
Average actions of items: 8.572458731537793
The number of inters: 197338
The sparsity of the dataset: 99.97823530928596%
Tue 06 Aug 2024 20:03:17 INFO 
====Validation====
clothing
The number of users: 39387
Average actions of users: 1.0193718739685682
The number of items: 16702
Average actions of items: 2.4039037241048975
The number of inters: 40150
The sparsity of the dataset: 99.99389670773579%
Tue 06 Aug 2024 20:03:17 INFO 
====Testing====
clothing
The number of users: 39387
Average actions of users: 1.0457511361616778
The number of items: 16803
Average actions of items: 2.451288460393977
The number of inters: 41189
The sparsity of the dataset: 99.99377640221293%
Tue 06 Aug 2024 20:03:26 INFO 

=================================


Tue 06 Aug 2024 20:03:26 INFO =========1/1: Parameters:['seed', 'shrink', 'knn_k']=(999, 10, 10)=======
Tue 06 Aug 2024 20:03:29 INFO ItemKNNCBF()
Trainable parameters: 2
Tue 06 Aug 2024 20:03:31 INFO epoch 0 training [time: 0.00s, train loss: 0.0000]
Tue 06 Aug 2024 20:03:45 INFO epoch 0 evaluating [time: 7.11s, valid_score: 0.028700]
Tue 06 Aug 2024 20:03:45 INFO valid result: 
recall@5: 0.0112    recall@10: 0.0175    recall@20: 0.0287    recall@50: 0.0429    ndcg@5: 0.0073    ndcg@10: 0.0094    ndcg@20: 0.0122    ndcg@50: 0.0151    precision@5: 0.0023    precision@10: 0.0018    precision@20: 0.0015    precision@50: 0.0009    map@5: 0.0060    map@10: 0.0069    map@20: 0.0076    map@50: 0.0081    
Tue 06 Aug 2024 20:03:45 INFO test result: 
recall@5: 0.0111    recall@10: 0.0177    recall@20: 0.0294    recall@50: 0.0434    ndcg@5: 0.0072    ndcg@10: 0.0094    ndcg@20: 0.0123    ndcg@50: 0.0152    precision@5: 0.0023    precision@10: 0.0019    precision@20: 0.0015    precision@50: 0.0009    map@5: 0.0059    map@10: 0.0067    map@20: 0.0075    map@50: 0.0080    
Tue 06 Aug 2024 20:03:45 INFO ██ ItemKNNCBF--Best validation results updated!!!
Tue 06 Aug 2024 20:03:45 INFO best valid result: recall@5: 0.0112    recall@10: 0.0175    recall@20: 0.0287    recall@50: 0.0429    ndcg@5: 0.0073    ndcg@10: 0.0094    ndcg@20: 0.0122    ndcg@50: 0.0151    precision@5: 0.0023    precision@10: 0.0018    precision@20: 0.0015    precision@50: 0.0009    map@5: 0.0060    map@10: 0.0069    map@20: 0.0076    map@50: 0.0081    
Tue 06 Aug 2024 20:03:45 INFO test result: recall@5: 0.0111    recall@10: 0.0177    recall@20: 0.0294    recall@50: 0.0434    ndcg@5: 0.0072    ndcg@10: 0.0094    ndcg@20: 0.0123    ndcg@50: 0.0152    precision@5: 0.0023    precision@10: 0.0019    precision@20: 0.0015    precision@50: 0.0009    map@5: 0.0059    map@10: 0.0067    map@20: 0.0075    map@50: 0.0080    
Tue 06 Aug 2024 20:03:45 INFO ████Current BEST████:
Parameters: ['seed', 'shrink', 'knn_k']=(999, 10, 10),
Valid: recall@5: 0.0112    recall@10: 0.0175    recall@20: 0.0287    recall@50: 0.0429    ndcg@5: 0.0073    ndcg@10: 0.0094    ndcg@20: 0.0122    ndcg@50: 0.0151    precision@5: 0.0023    precision@10: 0.0018    precision@20: 0.0015    precision@50: 0.0009    map@5: 0.0060    map@10: 0.0069    map@20: 0.0076    map@50: 0.0081    ,
Test: recall@5: 0.0111    recall@10: 0.0177    recall@20: 0.0294    recall@50: 0.0434    ndcg@5: 0.0072    ndcg@10: 0.0094    ndcg@20: 0.0123    ndcg@50: 0.0152    precision@5: 0.0023    precision@10: 0.0019    precision@20: 0.0015    precision@50: 0.0009    map@5: 0.0059    map@10: 0.0067    map@20: 0.0075    map@50: 0.0080    



Tue 06 Aug 2024 20:03:45 INFO 
============All Over=====================
Tue 06 Aug 2024 20:03:45 INFO Parameters: ['seed', 'shrink', 'knn_k']=(999, 10, 10),
 best valid: recall@5: 0.0112    recall@10: 0.0175    recall@20: 0.0287    recall@50: 0.0429    ndcg@5: 0.0073    ndcg@10: 0.0094    ndcg@20: 0.0122    ndcg@50: 0.0151    precision@5: 0.0023    precision@10: 0.0018    precision@20: 0.0015    precision@50: 0.0009    map@5: 0.0060    map@10: 0.0069    map@20: 0.0076    map@50: 0.0081    ,
 best test: recall@5: 0.0111    recall@10: 0.0177    recall@20: 0.0294    recall@50: 0.0434    ndcg@5: 0.0072    ndcg@10: 0.0094    ndcg@20: 0.0123    ndcg@50: 0.0152    precision@5: 0.0023    precision@10: 0.0019    precision@20: 0.0015    precision@50: 0.0009    map@5: 0.0059    map@10: 0.0067    map@20: 0.0075    map@50: 0.0080    
Tue 06 Aug 2024 20:03:45 INFO 

█████████████ BEST ████████████████
Tue 06 Aug 2024 20:03:45 INFO 	Parameters: ['seed', 'shrink', 'knn_k']=(999, 10, 10),
Valid: recall@5: 0.0112    recall@10: 0.0175    recall@20: 0.0287    recall@50: 0.0429    ndcg@5: 0.0073    ndcg@10: 0.0094    ndcg@20: 0.0122    ndcg@50: 0.0151    precision@5: 0.0023    precision@10: 0.0018    precision@20: 0.0015    precision@50: 0.0009    map@5: 0.0060    map@10: 0.0069    map@20: 0.0076    map@50: 0.0081    ,
Test: recall@5: 0.0111    recall@10: 0.0177    recall@20: 0.0294    recall@50: 0.0434    ndcg@5: 0.0072    ndcg@10: 0.0094    ndcg@20: 0.0123    ndcg@50: 0.0152    precision@5: 0.0023    precision@10: 0.0019    precision@20: 0.0015    precision@50: 0.0009    map@5: 0.0059    map@10: 0.0067    map@20: 0.0075    map@50: 0.0080    


